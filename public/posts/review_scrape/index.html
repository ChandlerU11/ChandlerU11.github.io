<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Building a Product Reviews Webscraper | Chandler Underwood</title>
<meta name="keywords" content="">
<meta name="description" content="Using the Python Requests and Beautiful Soup libraries, I construct a webscraper that can farm product reviews off of Zappos.com.">
<meta name="author" content="Chandler Underwood">
<link rel="canonical" href="https://chandleru11.github.io/posts/review_scrape/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css" integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z&#43;V9&#43;cO1A=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://chandleru11.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://chandleru11.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://chandleru11.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://chandleru11.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://chandleru11.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://chandleru11.github.io/posts/review_scrape/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Building a Product Reviews Webscraper" />
<meta property="og:description" content="Using the Python Requests and Beautiful Soup libraries, I construct a webscraper that can farm product reviews off of Zappos.com." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://chandleru11.github.io/posts/review_scrape/" /><meta property="og:image" content="https://chandleru11.github.io/images/papermod-cover.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-06-15T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-06-15T00:00:00+00:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://chandleru11.github.io/images/papermod-cover.png"/>

<meta name="twitter:title" content="Building a Product Reviews Webscraper"/>
<meta name="twitter:description" content="Using the Python Requests and Beautiful Soup libraries, I construct a webscraper that can farm product reviews off of Zappos.com."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://chandleru11.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Building a Product Reviews Webscraper",
      "item": "https://chandleru11.github.io/posts/review_scrape/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Building a Product Reviews Webscraper",
  "name": "Building a Product Reviews Webscraper",
  "description": "Using the Python Requests and Beautiful Soup libraries, I construct a webscraper that can farm product reviews off of Zappos.com.",
  "keywords": [
    
  ],
  "articleBody": "\r\u003c!DOCTYPE html\u003e Motivation Before we get into things, here’s a link to download the dataset if you would like.\nDo you ever find yourself pouring over a product’s reviews trying to decide if it’s right for you? I sure do. Many of these times I’ve wished there was a quick summary of the reviews I could read to speed up the decision process. I’ve yet to see any online retailers doing exactly what I’m looking for, so I’ve decided to make my own review summarizer. But, we need some data for training such a tool.\nFor this project I wanted to use data that was fun, interesting, and maybe even a little controversial… After much thought and deliberation over what product reviews to train a summary generator on, I landed on Crocs. Yes, I’m talking about the clunky rubber footwear my grandmother wears while gardening that some fashionistas would consider an abomination. What’s more fun than that??? Maybe or maybe not to your surprise, I searched the internet for a dataset containing reviews for Crocs to no avail. So, we’re going to have to find our own data. Follow along as I build a webscraper to farm reviews for Crocs Classic Clog, so we can train a review summarizer for the most loved and hated shoes on the planet!\nWhat tools can we use? There are several Python libraries that are helpful for webscraping:\nRequests: To send HTTP requests to websites. Beautiful Soup: For parsing HTML and XML documents. Selenium: For scraping dynamic web pages using browser automation. Pandas: To manipulate and store scraped data. In this project, I’ll be using Requests, Beautiful Soup, and Pandas. Selenium isn’t needed because we don’t need to click anything to move through the review pages on Zappos.com as you’ll see later.\nGetting Started Before we start scraping, we need to do some research, meaning that we need to go look around on the internet and assess potential sites for scraping. What sites would have a lot of product reviews for Crocs? The Crocs website itself, Amazon, and Zappos immediately come to mind. After following some initial site evaluation steps outlined here, I decided Zappos.com was the best place to scrape from.\nFirst, we need to figure out how to traverse the pages of reviews on Zappos.com. I went and clicked through the review pages and paid close attention to the URL. I noticed that it explicitly changes with each page. For example, https://www.zappos.com/product/review/7153812/page/1/orderBy/best takes you to the first page, and https://www.zappos.com/product/review/7153812/page/2/orderBy/best takes you to the second page. Easy. To traverse the pages, all we need to do is change a single character in the URL.\nSome Code to Download Whole Webpages I prefer to download whole web pages and extract data from them later. Why? Because companies oftentimes aren’t super happy about you scraping their data, and you have to be careful about how your traffic looks as you surf pages. Manners are important! Extracting data from HTML is a messy process that requires development, and you don’t want to risk having to rerun your scraper because you forgot to write the Beautiful Soup code to extract a product’s rating, for example. A script to traverse and download Zappos review pages is below.\nfrom bs4 import BeautifulSoup import requests import random import time HEADERS = ({'User-Agent':'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.71 Safari/537.36', 'From': 'chandler_underwood@yahoo.com'}) #Download raw HTML def getdata(url): r = requests.get(url, headers=HEADERS, timeout=5) return r.text #Convert HTML to parsable string def html_code(url): htmldata = getdata(url) soup = BeautifulSoup(htmldata, 'html.parser') return (soup) text = \"https://www.zappos.com/product/review/7153812/page/{insert}/orderBy/best\" #Iterate over all possible URLs for i in range(1, 1000): #Retrieve HTML print(\"Scraping: \" + text.format(insert = str(i))) code = html_code(text.format(insert = str(i))) #Save file with unique name file = open(\"path_to_folder/Zappos_Croc_File_\" + str(i) + \".html\",\"w\") file.write(str(code)) file.close() #Always remember to be polite time.sleep(random.randint(15,40)) Extracting Data from Webpages Now that we’ve downloaded the pages of reviews, we need to figure out how to extract the text from the HTML in a useful format. Google Chrome’s page inspect tool is great here as it allows us to click on items within the webpage and find their respective HTML tag names. As I clicked on the items I wanted to extract on the webpage, I took note of the tag names associated with them. Beautiful Soup uses these tag names to extract the text we need. Through some trial and error, I ended up with the following function to extract the desired text to make the reviews dataset.\ndef cus_rev_zappos(soup, b = True): review_text = [] date = [] rating = [] rating_type = [] rating_return = [] #Extract review for item in soup.find_all(\"div\", class_=\"Xl-z Yl-z\"): review_text.append(item.get_text()) #Extract review date for item in soup.find_all(\"time\"): date.append(item.get_text()) #Extract product rating for item in soup.find_all(\"span\", class_=\"HQ-z\"): rating.append(item.get_text()) #Extract product rating type (Overall, Style, Fit, etc.) for item in soup.find_all(\"em\", class_=\"Ql-z\"): rating_type.append(item.get_text()) #We only care about overall product ratings for this project rating = list(zip(rating[5:], rating_type)) for x in rating: if x[1] == 'Overall': rating_return.append(x[0]) return review, date, rating_return I then iterated over and extracted the text from the downloaded web pages using the following code, and we got a decent amount of data! There are over 9,000 distinct reviews here. Below is a glance at the data.\nfrom tqdm.notebook import tqdm reviews, ratings, dates = [], [], [] for x in tqdm(range(len(filenames))): f = open(\"path_to_folder/\" + filenames[x], 'r') soup = BeautifulSoup(f.read(), 'html.parser') review, date, rating = cus_rev_zappos(soup) reviews.extend(review) ratings.extend(rating) dates.extend(date) review_df = pd.DataFrame({'review': reviews, 'date': date, 'rating': ratings}) review_df.to_csv(\"Zappos_Croc_Reviews_Total.csv\") review_df.head(10) review date rating 0 !!!!!! E X C E L L E N T!!!!!!!!!! April 7, 2022 5.0 1 \"They're crocs; people know what crocs are.\" April 3, 2021 5.0 2 - Quick delivery and the product arrived when ... March 19, 2023 5.0 3 ...amazing \"new\" color!! who knew?? love - lov... July 17, 2022 5.0 4 0 complaints from me; this is the 8th pair of ... June 4, 2021 5.0 5 10/10 I ran from the cops in mine, and they ar... July 2, 2023 5.0 6 The 11 year old granddaughter loves them!!!!!! August 7, 2022 5.0 7 The 11 yr old daughter loves them. August 7, 2022 5.0 8 12M classic clogs made in Vietnam are great, a... April 25, 2023 1.0 9 My 13 year old grandson chose this color and l... March 13, 2023 5.0 Let’s make a wordcloud to get some understanding of the most popular words in the dataset.\nfrom wordcloud import WordCloud, STOPWORDS, ImageColorGenerator from os import path from PIL import Image import matplotlib.pyplot as plt # Start with one review: text = ' '.join(review_df['review'].to_list()).lower() # Create and generate a word cloud image: wordcloud = WordCloud(max_words=50, background_color=\"white\").generate(text) # Display the generated image: plt.imshow(wordcloud, interpolation='bilinear') plt.axis(\"off\") plt.show() “Croc” and “Love” seem to go together a lot. Why am I not surprised? :) I’m excited to see what I can do with this data in the future! Again, here’s the link to download the dataset if you’d like.\n",
  "wordCount" : "1168",
  "inLanguage": "en",
  "datePublished": "2024-06-15T00:00:00Z",
  "dateModified": "2024-06-15T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Chandler Underwood"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://chandleru11.github.io/posts/review_scrape/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Chandler Underwood",
    "logo": {
      "@type": "ImageObject",
      "url": "https://chandleru11.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://chandleru11.github.io/" accesskey="h" title="Chandler Underwood (Alt + H)">Chandler Underwood</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://chandleru11.github.io/about/" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="https://chandleru11.github.io/archives" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="https://chandleru11.github.io/projects" title="Projects">
                    <span>Projects</span>
                </a>
            </li>
            <li>
                <a href="https://chandleru11.github.io/publications" title="Publications">
                    <span>Publications</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://chandleru11.github.io/">Home</a>&nbsp;»&nbsp;<a href="https://chandleru11.github.io/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      Building a Product Reviews Webscraper
    </h1>
    <div class="post-description">
      Using the Python Requests and Beautiful Soup libraries, I construct a webscraper that can farm product reviews off of Zappos.com.
    </div>
    <div class="post-meta"><span title='2024-06-15 00:00:00 +0000 UTC'>June 15, 2024</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;Chandler Underwood

</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#motivation" aria-label="Motivation">Motivation</a></li>
                <li>
                    <a href="#what-tools-can-we-use" aria-label="What tools can we use?">What tools can we use?</a></li>
                <li>
                    <a href="#getting-started" aria-label="Getting Started">Getting Started</a></li>
                <li>
                    <a href="#some-code-to-download-whole-webpages" aria-label="Some Code to Download Whole Webpages">Some Code to Download Whole Webpages</a></li>
                <li>
                    <a href="#extracting-data-from-webpages" aria-label="Extracting Data from Webpages">Extracting Data from Webpages</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content">

<!DOCTYPE html>
<html>
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0NTZD30YVX"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-0NTZD30YVX');
</script>
</head>
</html>

<h1 id="motivation">Motivation<a hidden class="anchor" aria-hidden="true" href="#motivation">#</a></h1>
<p>Before we get into things, here&rsquo;s a <a href="https://www.kaggle.com/datasets/chandlerunderwood/crocs-clog-reviews/data">link</a> to download the dataset if you would like.</p>
<p>Do you ever find yourself pouring over a product&rsquo;s reviews trying to decide if it&rsquo;s right for you? I sure do. Many of these times I&rsquo;ve wished there was a quick summary of the reviews I could read to speed up the decision process. I&rsquo;ve yet to see any online retailers doing exactly what I&rsquo;m looking for, so I&rsquo;ve decided to make my own review summarizer. But, we need some data for training such a tool.</p>
<p>For this project I wanted to use data that was fun, interesting, and maybe even a little controversial&hellip; After much thought and deliberation over what product reviews to train a summary generator on, I landed on Crocs. Yes, I&rsquo;m talking about the clunky rubber footwear my grandmother wears while gardening that some fashionistas would consider an abomination. What&rsquo;s more fun than that??? Maybe or maybe not to your surprise, I searched the internet for a dataset containing reviews for Crocs to no avail. So, we&rsquo;re going to have to find our own data. Follow along as I build a webscraper to farm reviews for Crocs Classic Clog, so we can train a review summarizer for the most loved and hated shoes on the planet!</p>
<h1 id="what-tools-can-we-use">What tools can we use?<a hidden class="anchor" aria-hidden="true" href="#what-tools-can-we-use">#</a></h1>
<p>There are several Python libraries that are helpful for webscraping:</p>
<ul>
<li><strong>Requests:</strong> To send HTTP requests to websites.</li>
<li><strong>Beautiful Soup:</strong> For parsing HTML and XML documents.</li>
<li><strong>Selenium:</strong> For scraping dynamic web pages using browser automation.</li>
<li><strong>Pandas:</strong> To manipulate and store scraped data.</li>
</ul>
<p>In this project, I&rsquo;ll be using Requests, Beautiful Soup, and Pandas. Selenium isn&rsquo;t needed because we don&rsquo;t need to click anything to move through the review pages on Zappos.com as you&rsquo;ll see later.</p>
<h1 id="getting-started">Getting Started<a hidden class="anchor" aria-hidden="true" href="#getting-started">#</a></h1>
<p>Before we start scraping, we need to do some research, meaning that we need to go look around on the internet and assess potential sites for scraping. What sites would have a lot of product reviews for Crocs? The Crocs website itself, Amazon, and Zappos immediately come to mind. After following some initial site evaluation steps outlined <a href="https://towardsdatascience.com/web-scraping-basics-82f8b5acd45c#:~:text=You%20can%20look%20at%20the,you%20to%20scrape%20the%20website.">here</a>, I decided Zappos.com was the best place to scrape from.</p>
<p>First, we need to figure out how to traverse the pages of reviews on Zappos.com. I went and clicked through the review pages and paid close attention to the URL. I noticed that it explicitly changes with each page. For example, <a href="https://www.zappos.com/product/review/7153812/page/1/orderBy/best">https://www.zappos.com/product/review/7153812/page/1/orderBy/best</a> takes you to the first page, and <a href="https://www.zappos.com/product/review/7153812/page/2/orderBy/best">https://www.zappos.com/product/review/7153812/page/2/orderBy/best</a> takes you to the second page. Easy. To traverse the pages, all we need to do is change a single character in the URL.</p>
<h1 id="some-code-to-download-whole-webpages">Some Code to Download Whole Webpages<a hidden class="anchor" aria-hidden="true" href="#some-code-to-download-whole-webpages">#</a></h1>
<p>I prefer to download whole web pages and extract data from them later. Why? Because companies oftentimes aren&rsquo;t super happy about you scraping their data, and you have to be careful about how your traffic looks as you surf pages. Manners are important! Extracting data from HTML is a messy process that requires development, and you don&rsquo;t want to risk having to rerun your scraper because you forgot to write the Beautiful Soup code to extract a product&rsquo;s rating, for example. A script to traverse and download Zappos review pages is below.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">random</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">HEADERS</span> <span class="o">=</span> <span class="p">({</span><span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span><span class="s1">&#39;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.71 Safari/537.36&#39;</span><span class="p">,</span> <span class="s1">&#39;From&#39;</span><span class="p">:</span> <span class="s1">&#39;chandler_underwood@yahoo.com&#39;</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#Download raw HTML</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">getdata</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">HEADERS</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#Convert HTML to parsable string</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">html_code</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="n">htmldata</span> <span class="o">=</span> <span class="n">getdata</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">htmldata</span><span class="p">,</span> <span class="s1">&#39;html.parser&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="p">(</span><span class="n">soup</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">text</span> <span class="o">=</span> <span class="s2">&#34;https://www.zappos.com/product/review/7153812/page/</span><span class="si">{insert}</span><span class="s2">/orderBy/best&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#Iterate over all possible URLs</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#Retrieve HTML</span>
</span></span><span class="line"><span class="cl">	<span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Scraping: &#34;</span> <span class="o">+</span> <span class="n">text</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">insert</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">	<span class="n">code</span> <span class="o">=</span> <span class="n">html_code</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">insert</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">#Save file with unique name</span>
</span></span><span class="line"><span class="cl">	<span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;path_to_folder/Zappos_Croc_File_&#34;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34;.html&#34;</span><span class="p">,</span><span class="s2">&#34;w&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">code</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">	<span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="c1">#Always remember to be polite</span>
</span></span><span class="line"><span class="cl">	<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">40</span><span class="p">))</span>
</span></span></code></pre></div><h1 id="extracting-data-from-webpages">Extracting Data from Webpages<a hidden class="anchor" aria-hidden="true" href="#extracting-data-from-webpages">#</a></h1>
<p>Now that we&rsquo;ve downloaded the pages of reviews, we need to figure out how to extract the text from the HTML in a useful format. Google Chrome&rsquo;s page inspect tool is great here as it allows us to click on items within the webpage and find their respective HTML tag names.
<img loading="lazy" src="/Zappos_Insp.PNG" alt="Scenario 1: Across columns"  />
</p>
<p>As I clicked on the items I wanted to extract on the webpage, I took note of the tag names associated with them. Beautiful Soup uses these tag names to extract the text we need. Through some trial and error, I ended up with the following function to extract the desired text to make the reviews dataset.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">cus_rev_zappos</span><span class="p">(</span><span class="n">soup</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">  <span class="n">review_text</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">  <span class="n">date</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">  <span class="n">rating</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">  <span class="n">rating_type</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">  <span class="n">rating_return</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="c1">#Extract review</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">&#34;div&#34;</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s2">&#34;Xl-z Yl-z&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">      <span class="n">review_text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">get_text</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">#Extract review date</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">&#34;time&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">      <span class="n">date</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">get_text</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">#Extract product rating</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">&#34;span&#34;</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s2">&#34;HQ-z&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">      <span class="n">rating</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">get_text</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">#Extract product rating type (Overall, Style, Fit, etc.)</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">&#34;em&#34;</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s2">&#34;Ql-z&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">      <span class="n">rating_type</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">get_text</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">#We only care about overall product ratings for this project</span>
</span></span><span class="line"><span class="cl">  <span class="n">rating</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">rating</span><span class="p">[</span><span class="mi">5</span><span class="p">:],</span> <span class="n">rating_type</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">rating</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Overall&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">         <span class="n">rating_return</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">review</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">rating_return</span>
</span></span></code></pre></div><p>I then iterated over and extracted the text from the downloaded web pages using the following code, and we got a decent amount of data! There are over 9,000 distinct reviews here. Below is a glance at the data.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">tqdm.notebook</span> <span class="kn">import</span> <span class="n">tqdm</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">reviews</span><span class="p">,</span> <span class="n">ratings</span><span class="p">,</span> <span class="n">dates</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">filenames</span><span class="p">))):</span>
</span></span><span class="line"><span class="cl">  <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;path_to_folder/&#34;</span> <span class="o">+</span> <span class="n">filenames</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="s1">&#39;html.parser&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">review</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">rating</span> <span class="o">=</span> <span class="n">cus_rev_zappos</span><span class="p">(</span><span class="n">soup</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">reviews</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">review</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">ratings</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">rating</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">dates</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">date</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">review_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;review&#39;</span><span class="p">:</span> <span class="n">reviews</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="n">date</span><span class="p">,</span> <span class="s1">&#39;rating&#39;</span><span class="p">:</span> <span class="n">ratings</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">review_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&#34;Zappos_Croc_Reviews_Total.csv&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">review_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span></span></code></pre></div><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>review</th>
      <th>date</th>
      <th>rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>!!!!!! E X C E L L E N T!!!!!!!!!!</td>
      <td>April 7, 2022</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>"They're crocs; people know what crocs are."</td>
      <td>April 3, 2021</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>- Quick delivery and the product arrived when ...</td>
      <td>March 19, 2023</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>...amazing "new" color!! who knew?? love - lov...</td>
      <td>July 17, 2022</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0 complaints from me; this is the 8th pair of ...</td>
      <td>June 4, 2021</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>10/10 I ran from the cops in mine, and they ar...</td>
      <td>July 2, 2023</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>The 11 year old granddaughter loves them!!!!!!</td>
      <td>August 7, 2022</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>The 11 yr old daughter loves them.</td>
      <td>August 7, 2022</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>12M classic clogs made in Vietnam are great, a...</td>
      <td>April 25, 2023</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>My 13 year old grandson chose this color and l...</td>
      <td>March 13, 2023</td>
      <td>5.0</td>
    </tr>
  </tbody>
</table>
<p>Let&rsquo;s make a wordcloud to get some understanding of the most popular words in the dataset.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">wordcloud</span> <span class="kn">import</span> <span class="n">WordCloud</span><span class="p">,</span> <span class="n">STOPWORDS</span><span class="p">,</span> <span class="n">ImageColorGenerator</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">path</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Start with one review:</span>
</span></span><span class="line"><span class="cl"><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">review_df</span><span class="p">[</span><span class="s1">&#39;review&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Create and generate a word cloud image:</span>
</span></span><span class="line"><span class="cl"><span class="n">wordcloud</span> <span class="o">=</span> <span class="n">WordCloud</span><span class="p">(</span><span class="n">max_words</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">background_color</span><span class="o">=</span><span class="s2">&#34;white&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Display the generated image:</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">wordcloud</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;bilinear&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&#34;off&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span></code></pre></div><p><img loading="lazy" src="/wordcloud.png" alt="png"  />
</p>
<p>&ldquo;Croc&rdquo; and &ldquo;Love&rdquo; seem to go together a lot. Why am I not surprised? :) I&rsquo;m excited to see what I can do with this data in the future! Again, here&rsquo;s the <a href="https://www.kaggle.com/datasets/chandlerunderwood/crocs-clog-reviews/data">link</a> to download the dataset if you&rsquo;d like.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
<nav class="paginav">
  <a class="prev" href="https://chandleru11.github.io/posts/review_generizer/">
    <span class="title">« Prev</span>
    <br>
    <span>Using Unsupervised ML to &#39;Typicalize&#39; Product Reviews</span>
  </a>
  <a class="next" href="https://chandleru11.github.io/posts/clean_data/">
    <span class="title">Next »</span>
    <br>
    <span>Cleaning Up Years of Daily Running Data</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2025 <a href="https://chandleru11.github.io/">Chandler Underwood</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
